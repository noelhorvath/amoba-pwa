"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7266],{7266:(R,p,s)=>{s.r(p),s.d(p,{GameModule:()=>O});var l=s(9808),m=s(5636),e=s(4893);let v=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.ez,m.Pc]]}),t})(),G=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.ez,m.Pc,v]]}),t})();var _=s(3136),u=s(655),S=s(8496),h=s(8961),c=s(4899),T=s(859),C=s(8315),g=s(8271),f=s(6378);function w(t,r){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"ion-img",2,3),e.NdJ("mouseleave",function(){e.CHM(n);const o=e.MAs(2);return e.oxw().cellMouseLeaveHandler(o)})("mouseenter",function(){e.CHM(n);const o=e.MAs(2);return e.oxw().cellMouseEnterHandler(o)})("click",function(){return e.CHM(n),e.oxw().clickHandler()}),e.qZA(),e.BQk()}if(2&t){const n=e.oxw();e.xp6(1),e.Q6J("src",n.getImgFromCellValue())}}function y(t,r){if(1&t&&e._UZ(0,"ion-img",4),2&t){const n=e.oxw();e.Q6J("ngClass",n.imgClasses)("src",n.getImgFromCellValue())}}let I=(()=>{class t{constructor(){this.isPreview=!0,this.isAITurn=!1,this.imgClasses=["normal"],this.cellClick=new e.vpe}ngOnChanges(n){var i,o;n.gameState&&(this.imgClasses[0]=(null===(o=null===(i=this.gameState)||void 0===i?void 0:i.winnerCords)||void 0===o?void 0:o.find(a=>{var d;return a.y===(null===(d=this.cell)||void 0===d?void 0:d.y)&&a.x===this.cell.x}))?"winner":"normal")}getImgFromCellValue(){var n,i,o;if(!this.cell)throw new Error("Cell attribute is not set!");switch(this.cell.value){case g.x.BLACK:return null!==(n=this.blackImgSrc)&&void 0!==n?n:c.B.DEFAULT_BLACK_EMOTE.urls[0];case g.x.WHITE:return null!==(i=this.whiteImgSrc)&&void 0!==i?i:c.B.DEFAULT_WHITE_EMOTE.urls[0];case g.x.EMPTY:return null!==(o=this.emptyImgSrc)&&void 0!==o?o:c.B.DEFAULT_EMPTY_EMOTE.urls[0];default:throw new Error("Invalid board cell value!")}}cellMouseEnterHandler(n){var i,o,a;if(void 0===this.isGameRunning)throw new Error("isGameRunning attribute is not set!");if(void 0===this.playerTurn)throw new Error("playerTurn attribute is not set!");if(this.isGameRunning&&(null===(i=this.cell)||void 0===i?void 0:i.value)===g.x.EMPTY)switch(this.playerTurn){case f.C.BLACK:n.src=null!==(o=this.blackImgSrc)&&void 0!==o?o:c.B.DEFAULT_BLACK_EMOTE.urls[0];break;case f.C.WHITE:n.src=null!==(a=this.whiteImgSrc)&&void 0!==a?a:c.B.DEFAULT_WHITE_EMOTE.urls[0];break;default:throw new Error("Invalid player color!")}}cellMouseLeaveHandler(n){var i,o;if(void 0===this.isGameRunning)throw new Error("isGameRunning attribute is not set!");if(void 0===this.playerTurn)throw new Error("playerTurn attribute is not set!");this.isGameRunning&&(null===(i=this.cell)||void 0===i?void 0:i.value)===g.x.EMPTY&&(n.src=null!==(o=this.emptyImgSrc)&&void 0!==o?o:c.B.DEFAULT_EMPTY_EMOTE.urls[0])}clickHandler(){return(0,u.mG)(this,void 0,void 0,function*(){this.cellClick.emit(this.cell?this.cell.value===g.x.EMPTY?this.cell:new Error("Invalid move!"):new Error("Cell attribute is not set!"))})}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-game-board-cell"]],inputs:{cell:"cell",playerTurn:"playerTurn",gameMode:"gameMode",gameState:"gameState",whiteImgSrc:"whiteImgSrc",blackImgSrc:"blackImgSrc",emptyImgSrc:"emptyImgSrc",isGameRunning:"isGameRunning",isAITurn:"isAITurn",isPreview:"isPreview"},outputs:{cellClick:"cellClick"},features:[e.TTD],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["watchMode",""],[3,"src","mouseleave","mouseenter","click"],["img",""],[3,"ngClass","src"]],template:function(n,i){if(1&n&&(e.YNc(0,w,3,1,"ng-container",0),e.YNc(1,y,1,2,"ng-template",null,1,e.W1O)),2&n){const o=e.MAs(2);e.Q6J("ngIf",!i.isAITurn&&!i.isPreview)("ngIfElse",o)}},directives:[l.O5,m.Xz,l.mk],styles:[".normal[_ngcontent-%COMP%]{border:0}.winner[_ngcontent-%COMP%]{border:#2dd36f .15rem solid}"]}),t})();function M(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"ion-col")(1,"app-game-board-cell",2),e.NdJ("cellClick",function(o){return e.CHM(n),e.oxw(3).setMove(o)}),e.qZA()()}if(2&t){const n=r.$implicit,i=r.index,o=e.oxw().index,a=e.oxw(2);e.xp6(1),e.Q6J("playerTurn",a.playerTurn)("isGameRunning",a.isGameRunning)("isAITurn",a.isAITurn)("whiteImgSrc",a.whiteImgSrc)("blackImgSrc",a.blackImgSrc)("emptyImgSrc",a.emptyImgSrc)("cell",a.createCell(i,o,n))("gameState",a.gameState)("isPreview",a.isPreview)}}function b(t,r){if(1&t&&(e.TgZ(0,"ion-row"),e.YNc(1,M,2,9,"ion-col",1),e.qZA()),2&t){const n=r.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n)("ngForTrackBy",i.trackByCellValue)}}function E(t,r){if(1&t&&(e.ynx(0),e.TgZ(1,"ion-grid"),e.YNc(2,b,2,2,"ion-row",1),e.qZA(),e.BQk()),2&t){const n=e.oxw();e.xp6(2),e.Q6J("ngForOf",n.board.cells)("ngForTrackBy",n.trackByRow)}}let B=(()=>{class t{constructor(){this.isAITurn=!1,this.moveSet=new e.vpe,this.isGameRunning=!1}setMove(n){if(!this.playerTurn)throw new Error("Player turn is not set!");n instanceof Error?this.moveSet.emit(n):this.moveSet.emit(new C.b(n.x,n.y,h.G.playerColorToBoardCellValue(this.playerTurn)))}createCell(n,i,o){return new C.b(n,i,o)}trackByRow(n,i){return n}trackByCellValue(n,i){return n}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-game-board"]],inputs:{board:"board",gameMode:"gameMode",gameState:"gameState",whiteImgSrc:"whiteImgSrc",blackImgSrc:"blackImgSrc",emptyImgSrc:"emptyImgSrc",isGameRunning:"isGameRunning",playerTurn:"playerTurn",isPreview:"isPreview",isAITurn:"isAITurn"},outputs:{moveSet:"moveSet"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"playerTurn","isGameRunning","isAITurn","whiteImgSrc","blackImgSrc","emptyImgSrc","cell","gameState","isPreview","cellClick"]],template:function(n,i){1&n&&e.YNc(0,E,3,2,"ng-container",0),2&n&&e.Q6J("ngIf",i.board)},directives:[l.O5,m.jY,l.sg,m.Nd,m.wI,I],styles:["[_nghost-%COMP%]   ion-grid[_ngcontent-%COMP%]{border:#000000 .125rem solid;margin:0!important;padding:0!important}[_nghost-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{margin:0!important;padding:0!important}[_nghost-%COMP%]   ion-grid[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{background:#ffffff;border:#000000 .125rem solid;margin:0!important;padding:0!important}"]}),t})();function x(t,r){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"ion-button",5),e.NdJ("click",function(){return e.CHM(n),e.oxw().concedeGame()}),e._uU(2),e.qZA(),e.BQk()}if(2&t){const n=e.oxw();e.xp6(1),e.Q6J("hidden",!n.isGameRunning())("disabled",!n.isGameRunning()),e.xp6(1),e.hij(" ","Concede"," ")}}function A(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",5),e.NdJ("click",function(){return e.CHM(n),e.oxw().stopAIGame()}),e._uU(1),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("hidden",!n.isGameRunning())("disabled",!n.isGameRunning()),e.xp6(1),e.hij(" ","Stop"," ")}}const P=[{path:"",component:(()=>{class t{constructor(n,i,o){this.engine=n,this.gameSettingsService=i,this.message=o,this.gameSettingsChangedSubscription=this.gameSettingsService.gameSettingsChanged$.subscribe(()=>(0,u.mG)(this,void 0,void 0,function*(){try{this.gameSettings=yield this.gameSettingsService.get()}catch(a){yield this.message.createToast({header:"Game settings error",message:"Failed to load changed game settings!",buttons:["X"],position:"top",color:"danger",duration:2e3})}})),this.gameSettingsService.get().then(a=>{this.gameSettings=a,this.engine.setPreviewBoard(this.gameSettings.boardSize)}).catch(()=>(0,u.mG)(this,void 0,void 0,function*(){yield this.message.createToast({header:"Game settings error",message:"Failed to load game settings!",buttons:["X"],position:"top",color:"danger",duration:2e3})}))}getBoardState(){return this.engine.boardState$}getPlayerTurn(){return this.engine.playerTurn$}getGameState(){return this.engine.state$}isGameRunning(){return this.engine.isGameRunning()}startGame(){return(0,u.mG)(this,void 0,void 0,function*(){if(void 0===this.gameSettings)return yield this.message.createToast({header:"Start new game error",message:"Game settings are not available!",buttons:["X"],position:"top",color:"danger",duration:3e3});try{this.engine.startGame(this.gameSettings)}catch(n){n instanceof Error&&(console.log(n.stack),yield this.message.createToast({header:"Start new game error",message:n.message,buttons:["X"],position:"top",color:"danger",duration:3e3}))}})}ngOnDestroy(){var n;null===(n=this.gameSettingsChangedSubscription)||void 0===n||n.unsubscribe()}moveSetHandler(n){return(0,u.mG)(this,void 0,void 0,function*(){try{n instanceof Error?yield this.message.createToast({header:"Game move error",message:n.message,buttons:["X"],position:"top",color:"danger",duration:1e3}):this.engine.setMove(n)}catch(i){i instanceof Error&&(yield this.message.createToast({header:"Game error",message:i.message,buttons:["X"],position:"top",color:"danger",duration:1e3}))}})}concedeGame(){this.engine.concede()}isAITurn(){return this.engine.isAITurn()}isAIGame(){return this.engine.mode===S.G.AI_VS_AI}stopAIGame(){this.engine.stopAIGame()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(h.G),e.Y36(c.B),e.Y36(T.e))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-game"]],decls:11,vars:20,consts:[[1,"justify-content-center","align-items-center","page-content-container","ion-margin-start","ion-margin-end"],[3,"whiteImgSrc","blackImgSrc","isGameRunning","isPreview","gameState","gameMode","playerTurn","isAITurn","board","moveSet"],["color","secondary","expand","block",3,"hidden","disabled","click"],[4,"ngIf","ngIfElse"],["stopAIGameButton",""],["color","danger","expand","block",3,"hidden","disabled","click"]],template:function(n,i){if(1&n&&(e.TgZ(0,"ion-content")(1,"div",0)(2,"app-game-board",1),e.NdJ("moveSet",function(a){return i.moveSetHandler(a)}),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA(),e.TgZ(6,"ion-button",2),e.NdJ("click",function(){return i.startGame()}),e._uU(7),e.qZA(),e.YNc(8,x,3,3,"ng-container",3),e.YNc(9,A,2,3,"ng-template",null,4,e.W1O),e.qZA()()),2&n){const o=e.MAs(10);e.xp6(2),e.Q6J("whiteImgSrc",null==i.gameSettings||null==i.gameSettings.whiteEmote||null==i.gameSettings.whiteEmote.urls?null:i.gameSettings.whiteEmote.urls[3])("blackImgSrc",null==i.gameSettings||null==i.gameSettings.blackEmote||null==i.gameSettings.blackEmote.urls?null:i.gameSettings.blackEmote.urls[3])("isGameRunning",i.isGameRunning())("isPreview",!i.isGameRunning())("gameState",e.lcZ(3,14,i.getGameState()))("gameMode",null==i.gameSettings?null:i.gameSettings.gameMode)("playerTurn",e.lcZ(4,16,i.getPlayerTurn()))("isAITurn",i.isAITurn())("board",e.lcZ(5,18,i.getBoardState())),e.xp6(4),e.Q6J("hidden",i.isGameRunning())("disabled",i.isGameRunning()),e.xp6(1),e.hij(" ","Start new game"," "),e.xp6(1),e.Q6J("ngIf",!i.isAIGame())("ngIfElse",o)}},directives:[m.W2,B,m.YG,l.O5],pipes:[l.Ov],styles:["[_nghost-%COMP%]   .page-content-container[_ngcontent-%COMP%]{display:flex;min-height:100%;flex-direction:column;justify-content:center;align-content:center;align-items:center}[_nghost-%COMP%]   ion-button[_ngcontent-%COMP%]{min-width:98%}@media only screen and (min-width: 577px) and (max-width: 768px){[_nghost-%COMP%]   .page-content-container[_ngcontent-%COMP%]{margin-left:15%;margin-right:15%}}@media only screen and (min-width: 769px) and (max-width: 1080px){[_nghost-%COMP%]   .page-content-container[_ngcontent-%COMP%]{margin-left:15%;margin-right:15%}}@media only screen and (min-width: 1020px) and (max-width: 1400px){[_nghost-%COMP%]   .page-content-container[_ngcontent-%COMP%]{margin-left:30%;margin-right:30%}}@media only screen and (min-width: 1401px){[_nghost-%COMP%]   .page-content-container[_ngcontent-%COMP%]{margin-left:35%;margin-right:35%}}"]}),t})()}];let k=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[_.Bz.forChild(P)],_.Bz]}),t})(),O=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.ez,m.Pc,G,k]]}),t})()}}]);